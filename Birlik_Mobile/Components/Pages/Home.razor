@page "/home"
@inject NavigationManager NavManager
@inject Birlik_Mobile.Services.AuthService AuthService

<div class="text-center mt-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-3 text-muted">Redirigiendo...</p>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        await AuthService.InitializeAsync(); // 🔹 Carga la sesión guardada

        var rol = AuthService.CurrentUser?.Rol?.ToLower();

        if (string.IsNullOrEmpty(rol))
        {
            NavManager.NavigateTo("/", forceLoad: true);
            return;
        }

        switch (rol)
        {
            case "ejecutivo":
                NavManager.NavigateTo("/ejecutivo/dashboard", forceLoad: true);
                break;
            case "gerente":
                NavManager.NavigateTo("/gerente/dashboard", forceLoad: true);
                break;
            case "cliente":
                NavManager.NavigateTo("/cliente/dashboard", forceLoad: true);
                break;
            default:
                NavManager.NavigateTo("/", forceLoad: true);
                break;
        }
    }
}
