@page "/cliente/dashboard"
@using Birlik_Mobile.Services
@inject NavigationManager Nav
@inject AuthService AuthService
@inject NotificationService NotificationService

<div class="page-container">
    <!-- Header Section -->
    <div class="dashboard-header animate-enter">
        <div class="header-top">
            <div>
                <h1 class="greeting">Hola, @(AuthService.CurrentUser?.Nombre?.Split(' ')[0] ?? "Cliente")</h1>
                <p class="subtitle">Bienvenido a tu espacio seguro</p>
            </div>
            <div class="avatar-container">
                <span class="avatar-text">@GetInitials(AuthService.CurrentUser?.Nombre)</span>
            </div>
        </div>

        <!-- KPI Cards Scrollable -->
        <div class="kpi-scroll">
            <div class="kpi-card glass-panel">
                <div class="kpi-icon primary">
                    <i class="bi bi-shield-check"></i>
                </div>
                <div class="kpi-content">
                    <span class="kpi-value">3</span>
                    <span class="kpi-label">Pólizas Activas</span>
                </div>
            </div>

            <div class="kpi-card glass-panel">
                <div class="kpi-icon warning">
                    <i class="bi bi-calendar-event"></i>
                </div>
                <div class="kpi-content">
                    <span class="kpi-value">2</span>
                    <span class="kpi-label">Por Vencer</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Actions Grid -->
    <div class="section-title animate-enter" style="animation-delay: 0.1s">
        <h3>¿Qué deseas hacer?</h3>
    </div>

    <div class="actions-grid animate-enter" style="animation-delay: 0.2s">
        <div class="action-card glass-panel" @onclick='() => Nav.NavigateTo("/cliente/polizas")'>
            <div class="action-icon-bg blue">
                <i class="bi bi-shield-check"></i>
            </div>
            <span class="action-text">Mis Pólizas</span>
        </div>

        <div class="action-card glass-panel" @onclick='() => Nav.NavigateTo("/cliente/facturas")'>
            <div class="action-icon-bg green">
                <i class="bi bi-receipt"></i>
            </div>
            <span class="action-text">Facturas</span>
        </div>

        <div class="action-card glass-panel" @onclick='() => Nav.NavigateTo("/cliente/datos")'>
            <div class="action-icon-bg purple">
                <i class="bi bi-person-lines-fill"></i>
            </div>
            <span class="action-text">Mis Datos</span>
        </div>

        <div class="action-card glass-panel" @onclick='() => Nav.NavigateTo("/cliente/emergencia")'>
            <div class="action-icon-bg red">
                <i class="bi bi-telephone-fill"></i>
            </div>
            <span class="action-text">Emergencia</span>
        </div>
    </div>

    <!-- Promo / Info Card -->
    <div class="promo-card animate-enter" style="animation-delay: 0.3s">
        <div class="promo-content">
            <h4>Seguro de Viaje</h4>
            <p>Protege tus vacaciones desde $5/día</p>
            <button class="btn-sm-primary">Ver más</button>
        </div>
        <i class="bi bi-airplane-engines promo-icon"></i>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        await AuthService.InitializeAsync();
    }

    private string GetInitials(string name)
    {
        if (string.IsNullOrEmpty(name)) return "C";
        return name.Substring(0, 1).ToUpper();
    }
}