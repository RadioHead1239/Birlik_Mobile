@inject NavigationManager NavManager
@inject Birlik_Mobile.Services.AuthService AuthService

<nav class="glass-nav">
    <NavLink class="nav-item" href="home" Match="NavLinkMatch.All">
        <div class="icon-wrapper">
            <i class="bi bi-house-door"></i>
            <i class="bi bi-house-door-fill active-icon"></i>
        </div>
    </NavLink>

    @if (IsRole("Cliente"))
    {
        <NavLink class="nav-item" href="cliente/polizas">
            <div class="icon-wrapper">
                <i class="bi bi-file-earmark-text"></i>
                <i class="bi bi-file-earmark-text-fill active-icon"></i>
            </div>
        </NavLink>
        <NavLink class="nav-item" href="cliente/siniestros">
            <div class="icon-wrapper">
                <i class="bi bi-exclamation-circle"></i>
                <i class="bi bi-exclamation-circle-fill active-icon"></i>
            </div>
        </NavLink>
    }

    @if (IsRole("Ejecutivo"))
    {
        <NavLink class="nav-item" href="ejecutivo/clientes">
            <div class="icon-wrapper">
                <i class="bi bi-people"></i>
                <i class="bi bi-people-fill active-icon"></i>
            </div>
        </NavLink>
    }

    <NavLink class="nav-item" href="perfil">
        <div class="icon-wrapper">
            <i class="bi bi-person"></i>
            <i class="bi bi-person-fill active-icon"></i>
        </div>
    </NavLink>
    
    <div class="nav-item logout-btn" @onclick="Logout">
        <div class="icon-wrapper">
            <i class="bi bi-box-arrow-right"></i>
        </div>
    </div>
</nav>

@code {
    private bool IsRole(string role)
    {
        return AuthService.CurrentUser?.Rol?.Equals(role, StringComparison.OrdinalIgnoreCase) ?? false;
    }

    private async Task Logout()
    {
        await AuthService.LogoutAsync();
        NavManager.NavigateTo("/login", forceLoad: true);
    }
}
